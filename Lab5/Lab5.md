# ECE 593J - Lab 5 - Daniel Olsen
## Round Robin Scheduler
### Code
```c
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <sys/types.h>
#include <wait.h>

int finished;

struct node
{
	//Struct for the node of the queue
	pid_t pid;
	struct node *next;
};

struct queue
{
	//Struct for the queue
	struct node *front;
	struct node *back;

	int size;
};

void enqueue(struct queue *q, pid_t p)
{
	struct node* n = (struct node*) malloc (sizeof(struct node));

    n->pid = p;
    n->next = NULL;

    if (q->front == NULL)
	{
        q->front = n;
    } else{
        q->back->next = n;
    }

    q->back = n;
    q->size++;
}

pid_t dequeue(struct queue *q)
{
    struct node* front = q->front;
    pid_t p = front->pid;

    q->front = front->next;
    q->size--;

    free(front);
    return p;
}

void term_child()
{
	//Signal hanlder, the termination of a process
	signal(SIGCHLD, term_child);

	finished = 1;

}

int main(int argc, char const *argv[])
{
	int programCount = 0, i;
	pid_t child;
	int qt;

	struct queue q;
	q.front = NULL;
	q.back = NULL;
	q.size = 0;

	finished = 0;

	//Variable initialization
	signal(SIGCHLD, term_child);

	if(argc > 2)
	{
		qt = 1000 * atoi(&argv[1][0]); //Here you need the qt
	}
	else
	{
		printf("Usage: %s qt prog1 [prog2] ... [prog[N}\n", argv[0]);
		exit(-1);
	}

	for(programCount = 0, i = 2; i < argc; i++)
	{
		programCount++;
		//Fork, execl processes and enqueue
		printf("Message from father: Creating program %s\n", argv[i]);

		if((child = fork()) == 0)
		{
			execl(argv[i], argv[i], NULL);
		}

		enqueue(&q, child);
	}

	sleep(1);//Small safe delay

	printf("\nI am the Scheduler and I will now begin scheduling my programs:\n");

	while(q.front != NULL)//Scheduling loop
	{
		pid_t p = dequeue(&q);

		finished = 0;
		kill(p, SIGCONT);

		usleep(qt);

		if(!finished)
		{
			//send the signal SIGUSR1 to the first element in queue
			kill(p, SIGUSR1);

			usleep(1000);

			enqueue(&q, p);
		}
		else
		{
			printf("Child %d is finished\n", p);
			//remove from list
			//mark child as dead
		}
	}

	printf("All of my children finished so goodbye...\n");

	return 0;
}
```
###Output
```
dolsen@engEE-e121-Dxx ~/Git/ECE593J/Lab5 $ ./lab5-rr 50 p1 p3 p6 p9 p12
Message from father: Creating program p1
Message from father: Creating program p3
Message from father: Creating program p6
Message from father: Creating program p9
Message from father: Creating program p12

I am the Scheduler and I will now begin scheduling my programs:
Process 14747 starts...
This is program p1 and it prints for the 1 time...
This is program p1 and it prints for the 2 time...
This is program p1 and it prints for the 3 time...
This is program p1 and it prints for the 4 time...
This is program p1 and it prints for the 5 time...
Process 14747 ends...
Process 14748 starts...
This is program p3 and it prints for the 1 time...
This is program p3 and it prints for the 2 time...
This is program p3 and it prints for the 3 time...
This is program p3 and it prints for the 4 time...
This is program p3 and it prints for the 5 time...
Process 14748 ends...
Process 14749 starts...
This is program p6 and it prints for the 1 time...
This is program p6 and it prints for the 2 time...
This is program p6 and it prints for the 3 time...
This is program p6 and it prints for the 4 time...
This is program p6 and it prints for the 5 time...
Process 14749 ends...
Process 14750 starts...
This is program p9 and it prints for the 1 time...
This is program p9 and it prints for the 2 time...
This is program p9 and it prints for the 3 time...
This is program p9 and it prints for the 4 time...
This is program p9 and it prints for the 5 time...
Process 14750 ends...
Process 14751 starts...
This is program p12 and it prints for the 1 time...
This is program p12 and it prints for the 2 time...
This is program p12 and it prints for the 3 time...
This is program p12 and it prints for the 4 time...
This is program p12 and it prints for the 5 time...
Process 14751 ends...
Process 14747 starts...
This is program p1 and it prints for the 6 time...
This is program p1 and it prints for the 7 time...
Child 14747 is finished
Process 14748 starts...
This is program p3 and it prints for the 6 time...
This is program p3 and it prints for the 7 time...
This is program p3 and it prints for the 8 time...
This is program p3 and it prints for the 9 time...
Child 14748 is finished
Process 14749 starts...
This is program p6 and it prints for the 6 time...
This is program p6 and it prints for the 7 time...
This is program p6 and it prints for the 8 time...
This is program p6 and it prints for the 9 time...
This is program p6 and it prints for the 10 time...
Process 14749 ends...
Process 14750 starts...
This is program p9 and it prints for the 6 time...
This is program p9 and it prints for the 7 time...
This is program p9 and it prints for the 8 time...
This is program p9 and it prints for the 9 time...
This is program p9 and it prints for the 10 time...
Process 14750 ends...
Process 14751 starts...
This is program p12 and it prints for the 6 time...
This is program p12 and it prints for the 7 time...
This is program p12 and it prints for the 8 time...
This is program p12 and it prints for the 9 time...
This is program p12 and it prints for the 10 time...
Process 14751 ends...
Process 14749 starts...
This is program p6 and it prints for the 11 time...
This is program p6 and it prints for the 12 time...
Child 14749 is finished
Process 14750 starts...
This is program p9 and it prints for the 11 time...
This is program p9 and it prints for the 12 time...
This is program p9 and it prints for the 13 time...
This is program p9 and it prints for the 14 time...
This is program p9 and it prints for the 15 time...
Process 14750 ends...
Process 14751 starts...
This is program p12 and it prints for the 11 time...
This is program p12 and it prints for the 12 time...
This is program p12 and it prints for the 13 time...
This is program p12 and it prints for the 14 time...
This is program p12 and it prints for the 15 time...
Process 14751 ends...
Process 14750 starts...
Child 14750 is finished
Process 14751 starts...
This is program p12 and it prints for the 16 time...
This is program p12 and it prints for the 17 time...
This is program p12 and it prints for the 18 time...
Child 14751 is finished
All of my children finished so goodbye...
```
## MFQ Scheduler
### Code
```c
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <sys/types.h>
#include <wait.h>

int finished;

struct node
{
	//Struct for the node of the queue
	pid_t pid;
	struct node *next;
};

struct queue
{
	//Struct for the queue
	struct node *front;
	struct node *back;

	int size;
};

void enqueue(struct queue *q, pid_t p)
{
	struct node* n = (struct node*) malloc (sizeof(struct node));

    n->pid = p;
    n->next = NULL;

    if (q->front == NULL)
	{
        q->front = n;
    } else{
        q->back->next = n;
    }

    q->back = n;
    q->size++;
}

pid_t dequeue(struct queue *q)
{
    struct node* front = q->front;
    pid_t p = front->pid;

    q->front = front->next;
    q->size--;

    free(front);
    return p;
}

void term_child()
{
	//Signal hanlder, the termination of a process
	signal(SIGCHLD, term_child);

	finished = 1;

}

int main(int argc, char const *argv[])
{
	int programCount = 0, i;
	pid_t child;
	int qt1, qt2;

	struct queue q1;
	q1.front = NULL;
	q1.back = NULL;
	q1.size = 0;
	
	struct queue q2;
	q2.front = NULL;
	q2.back = NULL;
	q2.size = 0;

	finished = 0;

	//Variable initialization
	signal(SIGCHLD, term_child);

	if(argc > 3)
	{
		qt1 = 1000 * atoi(&argv[1][0]); //Here you need the qt
		qt2 = 1000 * atoi(&argv[2][0]);
	}
	else
	{
		printf("Usage: %s qt1 qt2 prog1 [prog2] ... [prog[N}\n", argv[0]);
		exit(-1);
	}
	
	for(programCount = 0, i = 3; i < argc; i++)
	{
		programCount++;
		//Fork, execl processes and enqueue
		printf("Message from father: Creating program %s\n", argv[i]);

		if((child = fork()) == 0)
		{
			execl(argv[i], argv[i], NULL);
		}

		enqueue(&q1, child);
	}

	sleep(1);//Small safe delay

	printf("\nI am the Scheduler and I will now begin scheduling my programs:\n");

	while(q1.front != NULL)//Scheduling loop
	{
		pid_t p = dequeue(&q1);

		finished = 0;
		kill(p, SIGCONT);

		usleep(qt1);

		if(!finished)
		{
			//send the signal SIGUSR1 to the first element in queue
			kill(p, SIGUSR1);

			usleep(1000);

			enqueue(&q2, p);
		}
		else
		{
			
			printf("Child %d is finished\n", p);
			//remove from list
			//mark child as dead
		}
	}
	
	while(q2.front != NULL)//Scheduling loop
	{
		pid_t p = dequeue(&q2);

		finished = 0;
		kill(p, SIGCONT);

		usleep(qt2);

		if(!finished)
		{
			//send the signal SIGUSR1 to the first element in queue
			kill(p, SIGUSR1);

			usleep(1000);

			enqueue(&q2, p);
		}
		else
		{
			
			printf("Child %d is finished\n", p);
			//remove from list
			//mark child as dead
		}
	}

	printf("All of my children finished so goodbye...\n");

	return 0;
}
```
### Output
```
dolsen@engEE-e121-Dxx ~/Git/ECE593J/Lab5 $ ./lab5-mfq 100 200 p1 p3 p6 p9 p12 p24 p48
Message from father: Creating program p1
Message from father: Creating program p3
Message from father: Creating program p6
Message from father: Creating program p9
Message from father: Creating program p12
Message from father: Creating program p24
Message from father: Creating program p48

I am the Scheduler and I will now begin scheduling my programs:
Process 14760 starts...
This is program p1 and it prints for the 1 time...
This is program p1 and it prints for the 2 time...
This is program p1 and it prints for the 3 time...
This is program p1 and it prints for the 4 time...
This is program p1 and it prints for the 5 time...
This is program p1 and it prints for the 6 time...
This is program p1 and it prints for the 7 time...
Child 14760 is finished
Process 14761 starts...
This is program p3 and it prints for the 1 time...
This is program p3 and it prints for the 2 time...
This is program p3 and it prints for the 3 time...
This is program p3 and it prints for the 4 time...
This is program p3 and it prints for the 5 time...
This is program p3 and it prints for the 6 time...
This is program p3 and it prints for the 7 time...
This is program p3 and it prints for the 8 time...
This is program p3 and it prints for the 9 time...
Child 14761 is finished
Process 14762 starts...
This is program p6 and it prints for the 1 time...
This is program p6 and it prints for the 2 time...
This is program p6 and it prints for the 3 time...
This is program p6 and it prints for the 4 time...
This is program p6 and it prints for the 5 time...
This is program p6 and it prints for the 6 time...
This is program p6 and it prints for the 7 time...
This is program p6 and it prints for the 8 time...
This is program p6 and it prints for the 9 time...
This is program p6 and it prints for the 10 time...
Process 14762 ends...
Process 14763 starts...
This is program p9 and it prints for the 1 time...
This is program p9 and it prints for the 2 time...
This is program p9 and it prints for the 3 time...
This is program p9 and it prints for the 4 time...
This is program p9 and it prints for the 5 time...
This is program p9 and it prints for the 6 time...
This is program p9 and it prints for the 7 time...
This is program p9 and it prints for the 8 time...
This is program p9 and it prints for the 9 time...
This is program p9 and it prints for the 10 time...
Process 14763 ends...
Process 14764 starts...
This is program p12 and it prints for the 1 time...
This is program p12 and it prints for the 2 time...
This is program p12 and it prints for the 3 time...
This is program p12 and it prints for the 4 time...
This is program p12 and it prints for the 5 time...
This is program p12 and it prints for the 6 time...
This is program p12 and it prints for the 7 time...
This is program p12 and it prints for the 8 time...
This is program p12 and it prints for the 9 time...
This is program p12 and it prints for the 10 time...
Process 14764 ends...
Process 14765 starts...
This is program p24 and it prints for the 1 time...
This is program p24 and it prints for the 2 time...
This is program p24 and it prints for the 3 time...
This is program p24 and it prints for the 4 time...
This is program p24 and it prints for the 5 time...
This is program p24 and it prints for the 6 time...
This is program p24 and it prints for the 7 time...
This is program p24 and it prints for the 8 time...
This is program p24 and it prints for the 9 time...
This is program p24 and it prints for the 10 time...
Process 14765 ends...
Process 14766 starts...
This is program p48 and it prints for the 1 time...
This is program p48 and it prints for the 2 time...
This is program p48 and it prints for the 3 time...
This is program p48 and it prints for the 4 time...
This is program p48 and it prints for the 5 time...
This is program p48 and it prints for the 6 time...
This is program p48 and it prints for the 7 time...
This is program p48 and it prints for the 8 time...
This is program p48 and it prints for the 9 time...
This is program p48 and it prints for the 10 time...
Process 14766 ends...
Process 14762 starts...
This is program p6 and it prints for the 11 time...
This is program p6 and it prints for the 12 time...
Child 14762 is finished
Process 14763 starts...
This is program p9 and it prints for the 11 time...
This is program p9 and it prints for the 12 time...
This is program p9 and it prints for the 13 time...
This is program p9 and it prints for the 14 time...
This is program p9 and it prints for the 15 time...
Child 14763 is finished
Process 14764 starts...
This is program p12 and it prints for the 11 time...
This is program p12 and it prints for the 12 time...
This is program p12 and it prints for the 13 time...
This is program p12 and it prints for the 14 time...
This is program p12 and it prints for the 15 time...
This is program p12 and it prints for the 16 time...
This is program p12 and it prints for the 17 time...
This is program p12 and it prints for the 18 time...
Child 14764 is finished
Process 14765 starts...
This is program p24 and it prints for the 11 time...
This is program p24 and it prints for the 12 time...
This is program p24 and it prints for the 13 time...
This is program p24 and it prints for the 14 time...
This is program p24 and it prints for the 15 time...
This is program p24 and it prints for the 16 time...
This is program p24 and it prints for the 17 time...
This is program p24 and it prints for the 18 time...
This is program p24 and it prints for the 19 time...
This is program p24 and it prints for the 20 time...
This is program p24 and it prints for the 21 time...
This is program p24 and it prints for the 22 time...
This is program p24 and it prints for the 23 time...
This is program p24 and it prints for the 24 time...
This is program p24 and it prints for the 25 time...
This is program p24 and it prints for the 26 time...
This is program p24 and it prints for the 27 time...
This is program p24 and it prints for the 28 time...
This is program p24 and it prints for the 29 time...
This is program p24 and it prints for the 30 time...
Process 14765 ends...
Process 14766 starts...
This is program p48 and it prints for the 11 time...
This is program p48 and it prints for the 12 time...
This is program p48 and it prints for the 13 time...
This is program p48 and it prints for the 14 time...
This is program p48 and it prints for the 15 time...
This is program p48 and it prints for the 16 time...
This is program p48 and it prints for the 17 time...
This is program p48 and it prints for the 18 time...
This is program p48 and it prints for the 19 time...
This is program p48 and it prints for the 20 time...
This is program p48 and it prints for the 21 time...
This is program p48 and it prints for the 22 time...
This is program p48 and it prints for the 23 time...
This is program p48 and it prints for the 24 time...
This is program p48 and it prints for the 25 time...
This is program p48 and it prints for the 26 time...
This is program p48 and it prints for the 27 time...
This is program p48 and it prints for the 28 time...
This is program p48 and it prints for the 29 time...
This is program p48 and it prints for the 30 time...
Process 14766 ends...
Process 14765 starts...
Child 14765 is finished
Process 14766 starts...
This is program p48 and it prints for the 31 time...
This is program p48 and it prints for the 32 time...
This is program p48 and it prints for the 33 time...
This is program p48 and it prints for the 34 time...
This is program p48 and it prints for the 35 time...
This is program p48 and it prints for the 36 time...
This is program p48 and it prints for the 37 time...
This is program p48 and it prints for the 38 time...
This is program p48 and it prints for the 39 time...
This is program p48 and it prints for the 40 time...
This is program p48 and it prints for the 41 time...
This is program p48 and it prints for the 42 time...
This is program p48 and it prints for the 43 time...
This is program p48 and it prints for the 44 time...
This is program p48 and it prints for the 45 time...
This is program p48 and it prints for the 46 time...
This is program p48 and it prints for the 47 time...
This is program p48 and it prints for the 48 time...
This is program p48 and it prints for the 49 time...
This is program p48 and it prints for the 50 time...
Process 14766 ends...
Process 14766 starts...
This is program p48 and it prints for the 51 time...
This is program p48 and it prints for the 52 time...
This is program p48 and it prints for the 53 time...
This is program p48 and it prints for the 54 time...
Child 14766 is finished
All of my children finished so goodbye...
```
